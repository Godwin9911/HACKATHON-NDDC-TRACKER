
<script src="js/general/third_party_cdn.js""></script>
<script src="js/general/placeholder.js""></script>
<script src="js/general/routes.js""></script>
<script>

const parsedUrl = new URL(window.location.href);
const getUrlParam = parsedUrl.searchParams

const code = getUrlParam.get('code');
console.log(code);



const handleData = () => {
    

    if(code == '501') {
        Swal.fire({
            title: `<h5>Not Implemented<h5>`,
            html:  `<p style="color:tomato; font-size:17px;">An unexpected error occured please try again or contact service support!</p>`,
            confirmButtonText: 'Close'
        }) 

    }else if (code == '403') {
        console.log('Not permmited')
        Swal.fire({
            title: `<h5>Not Allowed<h5>`,
            html:  `<p style="color:tomato; font-size:17px;">Your email is already registered with password, please use your password to login!</p>`,
            confirmButtonText: 'Close'
        }) 
    }else if (code == '200'){
        console.log('succcess')
          //insert the data into broswer localStorage
          const routes = new Routes();
          const url = `${routes.apiOrigin}${routes.}`; 
          fetch(url)
          .then(res => res.json())
          .then(data => {
              console.log(data)
              localStorage.setItem('nddc-tracker-user', JSON.stringify(data));
                if(data.user.user_type === 'community_member'){
                    location.replace('account/user/dashboard.html');
                }else if(data.user.user_type === 'reviewer') {
                    location.replace('account/reviewer/dashboard.html');
                }else if(data.user.user_type === 'contractor') {
                    location.replace('account/contractor/dashboard.html');
                }
                location.replace('account/user/dashboard.html')
          })
          .catch(err => {
              console.log(err)
          })
    }
    location.replace('login.html')
}

handleData();


</script>